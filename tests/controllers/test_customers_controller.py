# -*- coding: utf-8 -*-

"""
maxioadvancedbillingformerlychargifyapi

This file was automatically generated by APIMATIC v3.0 (
 https://www.apimatic.io ).
"""

import json
import dateutil.parser

from tests.controllers.controller_test_base import ControllerTestBase
from apimatic_core.utilities.comparison_helper import ComparisonHelper
from maxioadvancedbillingformerlychargifyapi.utilities.union_type_lookup import UnionTypeLookUp
from maxioadvancedbillingformerlychargifyapi.api_helper import APIHelper
from maxioadvancedbillingformerlychargifyapi.models.create_customer_request import CreateCustomerRequest


class CustomersControllerTests(ControllerTestBase):

    @classmethod
    def setUpClass(cls):
        super(CustomersControllerTests, cls).setUpClass()
        cls.controller = cls.client.customers
        cls.response_catcher = cls.controller.http_call_back

    # You may create a new Customer at any time, or you may create a Customer at the same time you create a Subscription. The only validation restriction is that you may only create one customer for a given reference value.
    #
    #If provided, the `reference` value must be unique. It represents a unique identifier for the customer from your own app, i.e. the customer’s ID. This allows you to retrieve a given customer via a piece of shared information. Alternatively, you may choose to leave `reference` blank, and store Chargify’s unique ID for the customer, which is in the `id` attribute.
    #
    #Full documentation on how to locate, create and edit Customers in the Chargify UI can be located [here](https://chargify.zendesk.com/hc/en-us/articles/4407659914267).
    #
    ### Required Country Format
    #
    #Chargify requires that you use the ISO Standard Country codes when formatting country attribute of the customer.
    #
    #Countries should be formatted as 2 characters. For more information, please see the following wikipedia article on [ISO_3166-1.](http://en.wikipedia.org/wiki/ISO_3166-1#Current_codes)
    #
    ### Required State Format
    #
    #Chargify requires that you use the ISO Standard State codes when formatting state attribute of the customer.
    #
    #+ US States (2 characters): [ISO_3166-2](https://en.wikipedia.org/wiki/ISO_3166-2:US)
    #
    #+ States Outside the US (2-3 characters): To find the correct state codes outside of the US, please go to [ISO_3166-1](http://en.wikipedia.org/wiki/ISO_3166-1#Current_codes) and click on the link in the “ISO 3166-2 codes” column next to country you wish to populate.
    #
    ### Locale
    #
    #Chargify allows you to attribute a language/region to your customer to deliver invoices in any required language.
    #For more: [Customer Locale](https://chargify.zendesk.com/hc/en-us/articles/4407870384283#customer-locale)
    def test_create_customer(self):
        # Parameters for the API call
        body = APIHelper.json_deserialize('{"customer":{"first_name":"Martha","last_name":"Washington","email'
            '":"martha@example.com","cc_emails":"george@example.com","organizat'
            'ion":"ABC, Inc.","reference":"1234567890","address":"123 Main Stre'
            'et","address_2":"Unit 10","city":"Anytown","state":"MA","zip":"021'
            '20","country":"US","phone":"555-555-1212","locale":"es-MX"}}', CreateCustomerRequest.from_dictionary)

        # Perform the API call through the SDK function
        result = self.controller.create_customer(body)

        # Test response code
        assert self.response_catcher.response.status_code == 200

        # Test headers
        expected_headers = {}
        expected_headers['content-type'] = 'application/json'

        assert ComparisonHelper.match_headers(expected_headers, self.response_catcher.response.headers)

        
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize('{"customer":{"first_name":"Cathryn","last_name":"Parisian","email"'
            ':"Stella.McLaughlin6@example.net","cc_emails":null,"organization":'
            '"Greenholt - Oberbrunner","reference":null,"id":76,"created_at":"2'
            '021-03-29T07:47:00-04:00","updated_at":"2021-03-29T07:47:00-04:00"'
            ',"address":"739 Stephon Bypass","address_2":"Apt. 386","city":"Sed'
            'rickchester","state":"KY","state_name":"Kentucky","zip":"46979-771'
            '9","country":"US","country_name":"United States","phone":"230-934-'
            '3685","verified":false,"portal_customer_created_at":null,"portal_i'
            'nvite_last_sent_at":null,"portal_invite_last_accepted_at":null,"ta'
            'x_exempt":false,"vat_number":null,"parent_id":null,"locale":"en-US'
            '"}}')
        received_body = APIHelper.json_deserialize(self.response_catcher.response.text)
        assert ComparisonHelper.match_body(expected_body, received_body)

    # This request will by default list all customers associated with your Site.
    #
    ### Find Customer
    #
    #Use the search feature with the `q` query parameter to retrieve an array of customers that matches the search query.
    #
    #Common use cases are:
    #
    #+ Search by an email
    #+ Search by a Chargify ID
    #+ Search by an organization
    #+ Search by a reference value from your application
    #+ Search by a first or last name
    #
    #To retrieve a single, exact match by reference, please use the [lookup endpoint](https://developers.chargify.com/docs/api-docs/b710d8fbef104-read-customer-by-reference).
    def test_list_customers(self):
        # Parameters for the API call
        direction = None
        page = 1
        per_page = 50
        date_field = 'updated_at'
        start_date = None
        end_date = None
        start_datetime = None
        end_datetime = None
        q = None

        # Perform the API call through the SDK function
        result = self.controller.list_customers(direction, page, per_page, date_field, start_date, end_date, start_datetime, end_datetime, q)

        # Test response code
        assert self.response_catcher.response.status_code == 200

        # Test headers
        expected_headers = {}
        expected_headers['content-type'] = 'application/json'

        assert ComparisonHelper.match_headers(expected_headers, self.response_catcher.response.headers)

        
        # Test whether the captured response is as we expected
        assert result is not None
        expected_body = APIHelper.json_deserialize('[{"customer":{"first_name":"Kayla","last_name":"Test","email":"kay'
            'la@example.com","cc_emails":"john@example.com, sue@example.com","o'
            'rganization":"","reference":null,"id":14126091,"created_at":"2016-'
            '10-04T15:22:27-04:00","updated_at":"2016-10-04T15:22:30-04:00","ad'
            'dress":"","address_2":"","city":"","state":"","zip":"","country":"'
            '","phone":"","verified":null,"portal_customer_created_at":"2016-10'
            '-04T15:22:29-04:00","portal_invite_last_sent_at":"2016-10-04T15:22'
            ':30-04:00","portal_invite_last_accepted_at":null,"tax_exempt":fals'
            'e}},{"customer":{"first_name":"Nick ","last_name":"Test","email":"'
            'nick@example.com","cc_emails":"john@example.com, sue@example.com",'
            '"organization":"","reference":null,"id":14254093,"created_at":"201'
            '6-10-13T16:52:51-04:00","updated_at":"2016-10-13T16:52:54-04:00","'
            'address":"","address_2":"","city":"","state":"","zip":"","country"'
            ':"","phone":"","verified":null,"portal_customer_created_at":"2016-'
            '10-13T16:52:54-04:00","portal_invite_last_sent_at":"2016-10-13T16:'
            '52:54-04:00","portal_invite_last_accepted_at":null,"tax_exempt":fa'
            'lse,"parent_id":123}},{"customer":{"first_name":"Don","last_name":'
            '"Test","email":"don@example.com","cc_emails":"john@example.com, su'
            'e@example.com","organization":"","reference":null,"id":14332342,"c'
            'reated_at":"2016-10-19T10:49:13-04:00","updated_at":"2016-10-19T10'
            ':49:19-04:00","address":"1737 15th St","address_2":"","city":"Boul'
            'der","state":"CO","zip":"80302","country":"US","phone":"","verifie'
            'd":null,"portal_customer_created_at":"2016-10-19T10:49:19-04:00","'
            'portal_invite_last_sent_at":"2016-10-19T10:49:19-04:00","portal_in'
            'vite_last_accepted_at":null,"tax_exempt":false,"parent_id":null}}]'
            '')
        received_body = APIHelper.json_deserialize(self.response_catcher.response.text)
        assert ComparisonHelper.match_body(expected_body, received_body)

